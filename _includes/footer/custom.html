<!-- start custom footer snippets -->


<div class="back-to-top"></div>

<style>
  .back-to-top {
    position: fixed;
    bottom: 30px;
    right: -120px; /* 初始在右侧隐藏 */
    width: 108px;
    height: 150px;
    background: url("/images/back-to-top.png?v=1") no-repeat 0 0;
    background-size: 108px 450px;
    cursor: pointer;
    opacity: 0.6;
    transition: right 0.6s ease, opacity 0.3s ease;
    z-index: 999;
  }

  .back-to-top:hover {
    opacity: 1;
    background-position: 0 -150px; /* 变换图像 */
  }

  .back-to-top.show {
    right: 30px; /* 滑入 */
  }

  /* 点击退出动画 */
  @keyframes leaveRight {
    from {
      transform: translateX(0);
    }
    to {
      transform: translateX(150px);
    }
  }

  .back-to-top.leave {
    animation: leaveRight 0.4s forwards;
  }
</style>

<script>
  (function () {
    let lock = false;
    let disabled = false; // 新增
    const btn = document.querySelector('.back-to-top');

    function handleScroll() {
      if (disabled) return;
      if (lock) return;

      if (window.scrollY > 100) {
        btn.classList.add('show');
      } else {
        btn.classList.remove('show');
      }
    }

    function handleClick() {
      lock = true;
      disabled = true; // 禁用 scroll 判断
      btn.classList.add('leave');

      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });

      setTimeout(() => {
        btn.classList.remove('leave');
        btn.classList.remove('show');
        lock = false;
        disabled = false; // 恢复 scroll 判断
      }, 600);
    }

    window.addEventListener('scroll', handleScroll);
    btn.addEventListener('click', handleClick);
  })();
</script>

<a href="/sitemap/">Sitemap</a>
<!-- end custom footer snippets -->
